  [1m[35m (21.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[35m (6.5ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(5932032579175995810)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateReservas (20211111171417)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "reservas" ("id" bigserial primary key, "sala" integer, "fecha" date, "asiento" integer, "horario" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (2.9ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_reservas_on_sala_and_fecha_and_asiento_and_horario" ON "reservas" ("sala", "fecha", "asiento", "horario")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20211111171417"]]
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateRooms (20211115224742)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (3.9ms)[0m  [1m[35mCREATE TABLE "rooms" ("id" bigserial primary key, "number" integer, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20211115224742"]]
  [1m[36mTRANSACTION (1.4ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateMovies (20211115224920)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (8.5ms)[0m  [1m[35mCREATE TABLE "movies" ("id" bigserial primary key, "title" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20211115224920"]]
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateMovieTimes (20211115225219)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (8.8ms)[0m  [1m[35mCREATE TABLE "movie_times" ("id" bigserial primary key, "movie" character varying, "room" integer, "time" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20211115225219"]]
  [1m[36mTRANSACTION (1.5ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateActiveStorageTables (20211123222824)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" bigserial primary key, "key" character varying NOT NULL, "filename" character varying NOT NULL, "content_type" character varying, "metadata" text, "service_name" character varying NOT NULL, "byte_size" bigint NOT NULL, "checksum" character varying NOT NULL, "created_at" timestamp NOT NULL)[0m
  [1m[35m (3.1ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (9.9ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" bigserial primary key, "name" character varying NOT NULL, "record_type" character varying NOT NULL, "record_id" bigint NOT NULL, "blob_id" bigint NOT NULL, "created_at" timestamp NOT NULL, CONSTRAINT "fk_rails_c3b3935057"
FOREIGN KEY ("blob_id")
  REFERENCES "active_storage_blobs" ("id")
)[0m
  [1m[35m (4.1ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (3.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (10.6ms)[0m  [1m[35mCREATE TABLE "active_storage_variant_records" ("id" bigserial primary key, "blob_id" bigint NOT NULL, "variation_digest" character varying NOT NULL, CONSTRAINT "fk_rails_993965df05"
FOREIGN KEY ("blob_id")
  REFERENCES "active_storage_blobs" ("id")
)[0m
  [1m[35m (3.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_variant_records_uniqueness" ON "active_storage_variant_records" ("blob_id", "variation_digest")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20211123222824"]]
  [1m[36mTRANSACTION (1.9ms)[0m  [1m[35mCOMMIT[0m
Migrating to AddRangoFechaToMovieTimes (20211124162849)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.2ms)[0m  [1m[35mALTER TABLE "movie_times" ADD "date_start" date NOT NULL, ADD "date_enf" date NOT NULL[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20211124162849"]]
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[35mCOMMIT[0m
Migrating to AddMovieIdToMovieTime (20211125033718)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "movie_times" DROP COLUMN "movie"[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "movie_times" ADD "movie_id" bigint NOT NULL[0m
  [1m[35m (3.9ms)[0m  [1m[35mCREATE INDEX "index_movie_times_on_movie_id" ON "movie_times" ("movie_id")[0m
  [1m[35m (1.8ms)[0m  [1m[35mALTER TABLE "movie_times" ADD CONSTRAINT "fk_rails_e6da71cf06"
FOREIGN KEY ("movie_id")
  REFERENCES "movies" ("id")
[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.8ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20211125033718"]]
  [1m[36mTRANSACTION (1.9ms)[0m  [1m[35mCOMMIT[0m
Migrating to FixTypo (20211125130104)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[35mALTER TABLE "movie_times" RENAME COLUMN "date_enf" TO "date_end"[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20211125130104"]]
  [1m[36mTRANSACTION (2.0ms)[0m  [1m[35mCOMMIT[0m
Migrating to AddImageToMovies (20211126195647)
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "movies" ADD "image" character varying[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20211126195647"]]
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[35mCOMMIT[0m
Migrating to AddNameToReservas (20221004204327)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[35mALTER TABLE "reservas" ADD "name" character varying[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20221004204327"]]
  [1m[36mTRANSACTION (1.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.6ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "test"], ["created_at", "2022-10-11 00:17:27.532293"], ["updated_at", "2022-10-11 00:17:27.532293"]]
  [1m[36mTRANSACTION (12.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_advisory_unlock(5932032579175995810)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL;ALTER TABLE "rooms" DISABLE TRIGGER ALL;ALTER TABLE "movies" DISABLE TRIGGER ALL;ALTER TABLE "reservas" DISABLE TRIGGER ALL;ALTER TABLE "active_storage_blobs" DISABLE TRIGGER ALL;ALTER TABLE "active_storage_attachments" DISABLE TRIGGER ALL;ALTER TABLE "movie_times" DISABLE TRIGGER ALL;ALTER TABLE "active_storage_variant_records" DISABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.6ms)[0m  [1m[31mDELETE FROM "movie_times";
DELETE FROM "movies";
DELETE FROM "reservas";
DELETE FROM "rooms"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL;ALTER TABLE "rooms" ENABLE TRIGGER ALL;ALTER TABLE "movies" ENABLE TRIGGER ALL;ALTER TABLE "reservas" ENABLE TRIGGER ALL;ALTER TABLE "active_storage_blobs" ENABLE TRIGGER ALL;ALTER TABLE "active_storage_attachments" ENABLE TRIGGER ALL;ALTER TABLE "movie_times" ENABLE TRIGGER ALL;ALTER TABLE "active_storage_variant_records" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (6.1ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_constraint SET convalidated=false WHERE conname = ''%I'' AND connamespace::regnamespace = ''%I''::regnamespace; ALTER TABLE %I.%I VALIDATE CONSTRAINT %I;',
    constraint_name,
    table_schema,
    table_schema,
    table_name,
    constraint_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (1.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------
ReservaTest: test_Reserva_creada_con_parametros_validos
-------------------------------------------------------
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMovie Create (0.5ms)[0m  [1m[32mINSERT INTO "movies" ("title", "created_at", "updated_at", "image") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Movie"], ["created_at", "2022-10-11 00:17:43.430137"], ["updated_at", "2022-10-11 00:17:43.430137"], ["image", nil]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMovie Load (0.4ms)[0m  [1m[34mSELECT "movies".* FROM "movies" WHERE "movies"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mMovieTime Load (0.5ms)[0m  [1m[34mSELECT "movie_times".* FROM "movie_times" WHERE ((('2022-10-10' <= date_end and '2022-10-10' >= date_start) or ('2022-10-12' <= date_end and '2022-10-12' >= date_start)) and time = 'TANDA' and room = 5)[0m
  [1m[36mMovieTime Create (0.6ms)[0m  [1m[32mINSERT INTO "movie_times" ("room", "time", "created_at", "updated_at", "date_start", "date_end", "movie_id") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["room", 5], ["time", "TANDA"], ["created_at", "2022-10-11 00:17:43.455158"], ["updated_at", "2022-10-11 00:17:43.455158"], ["date_start", "2022-10-10"], ["date_end", "2022-10-12"], ["movie_id", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReserva Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "reservas" WHERE "reservas"."sala" = $1 AND "reservas"."fecha" = $2 AND "reservas"."asiento" = $3 AND "reservas"."horario" = $4 LIMIT $5[0m  [["sala", 5], ["fecha", "2022-10-11"], ["asiento", 10], ["horario", "TANDA"], ["LIMIT", 1]]
  [1m[36mMovieTime Load (0.5ms)[0m  [1m[34mSELECT "movie_times".* FROM "movie_times" WHERE (('2022-10-11' <= date_end and '2022-10-11' >= date_start) and time = 'TANDA' and room = 5)[0m
  [1m[36mReserva Create (0.6ms)[0m  [1m[32mINSERT INTO "reservas" ("sala", "fecha", "asiento", "horario", "created_at", "updated_at", "name") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["sala", 5], ["fecha", "2022-10-11"], ["asiento", 10], ["horario", "TANDA"], ["created_at", "2022-10-11 00:17:43.474844"], ["updated_at", "2022-10-11 00:17:43.474844"], ["name", "Pedro"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mReserva Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "reservas" WHERE "reservas"."sala" = $1 AND "reservas"."id" != $2 AND "reservas"."fecha" = $3 AND "reservas"."asiento" = $4 AND "reservas"."horario" = $5 LIMIT $6[0m  [["sala", 5], ["id", 1], ["fecha", "2022-10-11"], ["asiento", 10], ["horario", "TANDA"], ["LIMIT", 1]]
  [1m[36mMovieTime Load (0.8ms)[0m  [1m[34mSELECT "movie_times".* FROM "movie_times" WHERE (('2022-10-11' <= date_end and '2022-10-11' >= date_start) and time = 'TANDA' and room = 5)[0m
  [1m[36mReserva Load (0.5ms)[0m  [1m[34mSELECT "reservas".* FROM "reservas"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReserva Destroy (0.3ms)[0m  [1m[31mDELETE FROM "reservas" WHERE "reservas"."id" = $1[0m  [["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mMovieTime Load (0.2ms)[0m  [1m[34mSELECT "movie_times".* FROM "movie_times"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMovieTime Destroy (0.2ms)[0m  [1m[31mDELETE FROM "movie_times" WHERE "movie_times"."id" = $1[0m  [["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mMovie Load (0.3ms)[0m  [1m[34mSELECT "movies".* FROM "movies"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = $1 AND "active_storage_attachments"."record_type" = $2 AND "active_storage_attachments"."name" = $3 LIMIT $4[0m  [["record_id", 1], ["record_type", "Movie"], ["name", "image"], ["LIMIT", 1]]
  [1m[36mMovieTime Load (0.3ms)[0m  [1m[34mSELECT "movie_times".* FROM "movie_times" WHERE "movie_times"."movie_id" = $1[0m  [["movie_id", 1]]
  [1m[36mMovie Destroy (0.5ms)[0m  [1m[31mDELETE FROM "movies" WHERE "movies"."id" = $1[0m  [["id", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
----------------------------------------
MovieControllerTest: test_should_get_new
----------------------------------------
Started GET "/movie/new" for 127.0.0.1 at 2022-10-10 21:17:43 -0300
Processing by MovieController#new as HTML
  Rendering layout layouts/application.html.erb
  Rendering movie/new.html.erb within layouts/application
  [1m[36mMovie Load (0.5ms)[0m  [1m[34mSELECT "movies".* FROM "movies" ORDER BY "movies"."title" ASC[0m
  Rendered movie/new.html.erb within layouts/application (Duration: 13.3ms | Allocations: 6519)
  Rendered layout layouts/application.html.erb (Duration: 406.0ms | Allocations: 99080)
Completed 200 OK in 417ms (Views: 409.3ms | ActiveRecord: 0.5ms | Allocations: 106103)
  [1m[36mMovieTime Load (0.4ms)[0m  [1m[34mSELECT "movie_times".* FROM "movie_times"[0m
  [1m[36mMovie Load (0.4ms)[0m  [1m[34mSELECT "movies".* FROM "movies"[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------
ReservasControllerTest: test_Posting_a_new_reserva
--------------------------------------------------
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMovie Create (0.4ms)[0m  [1m[32mINSERT INTO "movies" ("title", "created_at", "updated_at", "image") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Matrix"], ["created_at", "2022-10-11 00:17:44.191419"], ["updated_at", "2022-10-11 00:17:44.191419"], ["image", nil]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMovie Load (0.4ms)[0m  [1m[34mSELECT "movies".* FROM "movies" WHERE "movies"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mMovieTime Load (0.6ms)[0m  [1m[34mSELECT "movie_times".* FROM "movie_times" WHERE ((('2000-11-10' <= date_end and '2000-11-10' >= date_start) or ('2000-11-12' <= date_end and '2000-11-12' >= date_start)) and time = 'TANDA' and room = 5)[0m
  [1m[36mMovieTime Create (0.6ms)[0m  [1m[32mINSERT INTO "movie_times" ("room", "time", "created_at", "updated_at", "date_start", "date_end", "movie_id") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["room", 5], ["time", "TANDA"], ["created_at", "2022-10-11 00:17:44.197249"], ["updated_at", "2022-10-11 00:17:44.197249"], ["date_start", "2000-11-10"], ["date_end", "2000-11-12"], ["movie_id", 2]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mReserva Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "reservas"[0m
Started POST "/reservas/new/5/2000-11-12/TANDA" for 127.0.0.1 at 2022-10-10 21:17:44 -0300
Processing by ReservasController#create as HTML
  Parameters: {"reservation_seats"=>"C-3", "name"=>"Diego", "sala"=>"5", "fecha"=>"2000-11-12", "horario"=>"TANDA"}
  [1m[36mReserva Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "reservas" WHERE "reservas"."sala" = $1 AND "reservas"."fecha" = $2 AND "reservas"."asiento" = $3 AND "reservas"."horario" = $4 LIMIT $5[0m  [["sala", 5], ["fecha", "2000-11-12"], ["asiento", 27], ["horario", "TANDA"], ["LIMIT", 1]]
  [1m[36mMovieTime Load (0.4ms)[0m  [1m[34mSELECT "movie_times".* FROM "movie_times" WHERE (('2000-11-12' <= date_end and '2000-11-12' >= date_start) and time = 'TANDA' and room = 5)[0m
  [1m[36mCACHE Reserva Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "reservas" WHERE "reservas"."sala" = $1 AND "reservas"."fecha" = $2 AND "reservas"."asiento" = $3 AND "reservas"."horario" = $4 LIMIT $5[0m  [["sala", 5], ["fecha", "2000-11-12"], ["asiento", 27], ["horario", "TANDA"], ["LIMIT", 1]]
  [1m[36mCACHE MovieTime Load (0.0ms)[0m  [1m[34mSELECT "movie_times".* FROM "movie_times" WHERE (('2000-11-12' <= date_end and '2000-11-12' >= date_start) and time = 'TANDA' and room = 5)[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReserva Create (0.4ms)[0m  [1m[32mINSERT INTO "reservas" ("sala", "fecha", "asiento", "horario", "created_at", "updated_at", "name") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["sala", 5], ["fecha", "2000-11-12"], ["asiento", 27], ["horario", "TANDA"], ["created_at", "2022-10-11 00:17:44.214502"], ["updated_at", "2022-10-11 00:17:44.214502"], ["name", "Diego"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/reservas/new/5/2000-11-12/TANDA?success=true
Completed 302 Found in 8ms (ActiveRecord: 1.6ms | Allocations: 2004)
  [1m[36mReserva Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "reservas"[0m
  [1m[36mReserva Load (0.5ms)[0m  [1m[34mSELECT "reservas".* FROM "reservas"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReserva Destroy (0.3ms)[0m  [1m[31mDELETE FROM "reservas" WHERE "reservas"."id" = $1[0m  [["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mMovieTime Load (0.2ms)[0m  [1m[34mSELECT "movie_times".* FROM "movie_times"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMovieTime Destroy (0.2ms)[0m  [1m[31mDELETE FROM "movie_times" WHERE "movie_times"."id" = $1[0m  [["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mMovie Load (0.2ms)[0m  [1m[34mSELECT "movies".* FROM "movies"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.7ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = $1 AND "active_storage_attachments"."record_type" = $2 AND "active_storage_attachments"."name" = $3 LIMIT $4[0m  [["record_id", 2], ["record_type", "Movie"], ["name", "image"], ["LIMIT", 1]]
  [1m[36mMovieTime Load (0.6ms)[0m  [1m[34mSELECT "movie_times".* FROM "movie_times" WHERE "movie_times"."movie_id" = $1[0m  [["movie_id", 2]]
  [1m[36mMovie Destroy (0.9ms)[0m  [1m[31mDELETE FROM "movies" WHERE "movies"."id" = $1[0m  [["id", 2]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------
MovieTest: test_Movie_con_parametros_validos
--------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMovie Create (0.5ms)[0m  [1m[32mINSERT INTO "movies" ("title", "created_at", "updated_at", "image") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["title", "Matrix"], ["created_at", "2022-10-11 00:17:44.238571"], ["updated_at", "2022-10-11 00:17:44.238571"], ["image", nil]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mMovie Load (0.3ms)[0m  [1m[34mSELECT "movies".* FROM "movies"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = $1 AND "active_storage_attachments"."record_type" = $2 AND "active_storage_attachments"."name" = $3 LIMIT $4[0m  [["record_id", 3], ["record_type", "Movie"], ["name", "image"], ["LIMIT", 1]]
  [1m[36mMovieTime Load (0.3ms)[0m  [1m[34mSELECT "movie_times".* FROM "movie_times" WHERE "movie_times"."movie_id" = $1[0m  [["movie_id", 3]]
  [1m[36mMovie Destroy (0.5ms)[0m  [1m[31mDELETE FROM "movies" WHERE "movies"."id" = $1[0m  [["id", 3]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
